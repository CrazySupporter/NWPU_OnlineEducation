webpackJsonp([19],{hQ1N:function(e,t){},lh6o:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("BO1k"),n=s.n(a),r=s("7+uW"),i=s("pCWl"),o={name:"ElTabPane",componentName:"ElTabPane",props:{label:String,labelContent:Function,name:String,closable:Boolean,disabled:Boolean,lazy:Boolean,fly:Boolean},data:function(){return{index:null,loaded:!1}},computed:{isClosable:function(){return this.closable||this.$parent.closable},active:function(){var e=this.$parent.currentName===(this.name||this.index);return e&&(this.loaded=!0),e},paneName:function(){return this.name||this.index}},watch:{label:function(){this.$parent.$forceUpdate()}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return!e.lazy||e.loaded||e.active?s("div",{directives:[{name:"show",rawName:"v-show",value:e.active||e.fly,expression:"active || fly"},{name:"visible",rawName:"v-visible",value:e.active||!e.fly,expression:"active || !fly"}],staticClass:"my-tab-pane",attrs:{role:"tabpanel","aria-hidden":!e.active,id:"pane-"+e.paneName,"aria-labelledby":"tab-"+e.paneName}},[e._t("default")],2):e._e()},staticRenderFns:[]},c=s("VU/8")(o,l,!1,null,null,null).exports,u=["details"];for(var d in i.supported_resources)r.default.component("sub-"+i.supported_resources[d].name,i.supported_resources[d].component);var p={data:function(){return{title:void 0,activeTitle:"details",activeIndex:"",class_resources:null,course_status:{class_id:null,role_title:null,role:null},loading:!0,new_problem_dialog_visible:!1}},props:["user"],sockets:{message:function(e){e.course_id===this.$route.params.class_id&&(console.log("[new message]",e),this.$notify({title:e.realname+(0===e.course_status?"（老师）":"")+":",message:e.message}),this.$socket.emit("received"))},alert:function(e){"PROBLEM_PUBLISH."===e.operation&&this.$message("你有新的习题，快去看看吧!")}},computed:{fly:function(){return"live"!==this.class_resources[this.activeIndex]},options:function(){var e=[],t=this.class_resources?this.class_resources:u,s=null===this.course_status.role?3:this.course_status.role,a=!0,r=!1,o=void 0;try{for(var l,c=n()(t);!(a=(l=c.next()).done);a=!0){var d=l.value;e.push({index:d,name:i.supported_resources[d].title,component:i.supported_resources[d].component,disabled:!i.supported_resources[d].access[s]})}}catch(e){r=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(r)throw o}}return e}},mounted:function(){var e=this;this.activeIndex=this.getActiveName(),this.title=this.$route.params.class_id,this.$http.post("/api/class/resources/query",{class_id:this.title},null).then(function(t){return e.class_resources=t.body.resources,e.loading=!1,e.activeIndex=e.getActiveName(),e.$http.post("/api/class/status",{class_id:e.title},null)}).then(function(t){"SUCCESS."===t.body.status?(e.course_status.role=t.body.results.role,0===e.course_status.role?e.course_status.role_title="教师":1===e.course_status.role?e.course_status.role_title="助教":2===e.course_status.role?e.course_status.role_title="学生":e.course_status.role_title="未知",e.loading=!1):"NOT_LOGIN."===t.body.details?(e.$message.warning("请先登录。"),e.$router.push("/user/sign_in")):"NOT_IN_CLASS."===t.body.details?e.$message.warning("用户没有加入班级"):(e.$message.error("错误，见console"),console.log("[error in dashboard]",t.body))}).catch(function(t){e.loading=!1})},methods:{whereIs:function(e){var t=this.class_resources?this.class_resources:u,s=0,a=!0,r=!1,i=void 0;try{for(var o,l=n()(t);!(a=(o=l.next()).done);a=!0){if(o.value===e)return""+s;s+=1}}catch(e){r=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}return"0"},handleNewProblemClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleNewProblemConfirm:function(){this.activeIndex=this.whereIs("train_area"),this.new_problem_dialog_visible=!1},handleNewProblemCancel:function(){this.new_problem_dialog_visible=!1},onTabClick:function(e){this.$router.push({name:"class-"+this.options[e.paneName].index,params:{class_id:this.title}})},getActiveName:function(){var e=this.class_resources?this.class_resources:u,t=0,s=this.$route.path.split("/")[3],a=!0,r=!1,i=void 0;try{for(var o,l=n()(e);!(a=(o=l.next()).done);a=!0){if(o.value===s)return""+t;t+=1}}catch(e){r=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}return"0"}},components:{TabPane:c}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"750px"},attrs:{type:"border-card",lazy:!1},on:{"tab-click":e.onTabClick},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},e._l(e.options,function(t){return s("TabPane",{key:t.index,attrs:{disabled:t.disabled,label:t.name,name:e.options.route,fly:"live"===t.index}},["live"===t.index||t.disabled?e._e():s(t.component,{ref:t.index,refInFor:!0,tag:"components",staticClass:"lecture-panel",attrs:{course_status:e.course_status,index:e.activeTitle}}),e._v(" "),"live"!==t.index||t.disabled?e._e():s(t.component,{ref:t.index,refInFor:!0,tag:"components",staticClass:"lecture-panel",attrs:{course_status:e.course_status,index:e.activeTitle,fly:e.fly,user:e.user}})],1)})),e._v(" "),s("el-dialog",{attrs:{title:"新的习题",visible:e.new_problem_dialog_visible,width:"30%","before-close":e.handleNewProblemClose},on:{"update:visible":function(t){e.new_problem_dialog_visible=t}}},[s("span",[e._v("刚刚，老师发布了新的习题")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.handleNewProblemCancel}},[e._v("留在这里")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.handleNewProblemConfirm}},[e._v("去看看")])],1)])],1)},staticRenderFns:[]};var h=s("VU/8")(p,_,!1,function(e){s("hQ1N")},"data-v-479142f2",null);t.default=h.exports}});
//# sourceMappingURL=19.ba4ea326257bdd9302df.js.map