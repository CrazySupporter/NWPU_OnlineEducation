webpackJsonp([25],{aEAj:function(e,t){},cd83:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("3IC3"),s=n("mtWM"),r=n.n(s),o=(n("Cp0N"),{name:"ChangePhone",props:["user"],data:function(){return{title:"修改手机号",inputs:{oldPhoneNumber:void 0,newPhoneNumber:void 0,priVerifyCode:void 0,newVerifyCode:void 0,userid:void 0},oldVerify:{code_generated:"",prompt:"发送验证",countdown:60,disableQ:!1},newVerify:{code_generated:"",prompt:"发送验证",countdown:60,disableQ:!1},loadingQ:!1,expire_secs:720}},methods:{handleChangePhone:function(){var e=this;this.inputs.oldPhoneNumber=this.user.phone,this.inputs.userid=this.user.user_id,Object(i.changePhoneSQL)(this,this.inputs).then(function(t){e.$emit("logout"),e.$router.push("/home")}).catch(function(t){"WRONG_OLD_VERIFICATION_CODE."===t.details?e.$message.error("修改密码失败，原手机验证码不正确！"):"WRONG_NEW_VERIFICATION_CODE."===t.details&&e.$message.error("修改密码失败，新手机验证码不正确")})},handleOldVerification:function(){var e=this;this.inputs.oldPhoneNumber=this.user.phone;var t=void 0;t=window.setInterval(function(){e.oldVerify.disableQ=!0,e.oldVerify.countdown--,e.oldVerify.prompt=e.oldVerify.countdown+"s后重新发送",e.oldVerify.countdown<=0&&(window.clearInterval(t),e.oldVerify.disableQ=!1,e.oldVerify.prompt="重新发送验证码",e.oldVerify.countdown=60)},1e3),this.$message.warning("原手机验证码已发送！请注意查收"),this.$refs.verify_input.focus();r.a.post("/api/user/verification",{number:this.inputs.oldPhoneNumber}).then(function(e){})},handleNewVerification:function(){var e=this,t=void 0;this.inputs.newPhoneNumber<=1e10||this.inputs.newPhoneNumber>=19999999999||void 0===this.inputs.newPhoneNumber?this.$message("请输入中国大陆11位手机号"):Object(i.queryPhoneSQL)(this,{phone:this.inputs.newPhoneNumber}).then(function(t){"SUCCESS."!==t.status||e.$message("该手机号已经被注册")}).catch(function(n){if("FAILED."===n.status){t=window.setInterval(function(){e.newVerify.disableQ=!0,e.newVerify.countdown--,e.newVerify.prompt=e.newVerify.countdown+"s后重新发送",e.newVerify.countdown<=0&&(window.clearInterval(t),e.newVerify.disableQ=!1,e.newVerify.prompt="重新发送验证码",e.newVerify.countdown=60)},1e3),e.$message.warning("验证码已发送！请注意查收"),e.$refs.verify_input.focus();r.a.post("/api/user/verification",{number:e.inputs.newPhoneNumber}).then(function(e){})}})}}}),a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingQ,expression:"loadingQ"}],staticClass:"box-card"},[n("div",{staticClass:"clear-fix",attrs:{slot:"header"},slot:"header"},[n("h1",[e._v(e._s(e.title))])]),e._v(" "),n("div",[e._v("\n        notice:  修改成功后将会重新登录\n    ")]),e._v(" "),n("div",{on:{keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleChangePassword(t):null}}},[n("el-row",[n("el-col",{staticClass:"register-prompt",attrs:{span:8}},[n("label",[n("i",{staticClass:"el-icon-caret-right",attrs:{slot:"prepend"},slot:"prepend"}),e._v("\n                    新手机号:\n                ")])]),e._v(" "),n("el-col",{attrs:{span:13}},[n("el-input",{staticClass:"input-box",attrs:{type:"text",clearable:""},model:{value:e.inputs.newPhoneNumber,callback:function(t){e.$set(e.inputs,"newPhoneNumber",t)},expression:"inputs.newPhoneNumber"}})],1)],1),e._v(" "),n("el-row",[n("el-col",{staticClass:"register-prompt",attrs:{span:8}},[n("label",[n("i",{staticClass:"el-icon-caret-right",attrs:{slot:"prepend"},slot:"prepend"}),e._v("\n                    验证原手机：\n                ")])]),e._v(" "),n("el-col",{attrs:{span:7}},[n("el-input-number",{ref:"verify_input",staticClass:"input-box",attrs:{min:1e5,max:999999,controls:!1},model:{value:e.inputs.priVerifyCode,callback:function(t){e.$set(e.inputs,"priVerifyCode",t)},expression:"inputs.priVerifyCode"}})],1),e._v(" "),n("el-col",{staticClass:"verification-button",attrs:{span:7}},[n("el-button",{attrs:{type:"primary",disabled:e.oldVerify.disableQ},on:{click:e.handleOldVerification}},[e._v("\n                    "+e._s(e.oldVerify.prompt)+"\n                ")])],1)],1),e._v(" "),n("el-row",[n("el-col",{staticClass:"register-prompt",attrs:{span:8}},[n("label",[n("i",{staticClass:"el-icon-caret-right",attrs:{slot:"prepend"},slot:"prepend"}),e._v("\n                    验证新手机：\n                ")])]),e._v(" "),n("el-col",{attrs:{span:7}},[n("el-input-number",{ref:"verify_input",staticClass:"input-box",attrs:{min:1e5,max:999999,controls:!1},model:{value:e.inputs.newVerifyCode,callback:function(t){e.$set(e.inputs,"newVerifyCode",t)},expression:"inputs.newVerifyCode"}})],1),e._v(" "),n("el-col",{staticClass:"verification-button",attrs:{span:7}},[n("el-button",{attrs:{type:"primary",disabled:e.newVerify.disableQ},on:{click:e.handleNewVerification}},[e._v("\n                    "+e._s(e.newVerify.prompt)+"\n                ")])],1)],1)],1),e._v(" "),n("div",{attrs:{align:"center"}},[n("el-row",[n("el-button",{staticClass:"register-button",attrs:{type:"success"},on:{click:e.handleChangePhone}},[e._v("修改手机号")])],1)],1)])},staticRenderFns:[]};var l=n("VU/8")(o,a,!1,function(e){n("aEAj")},"data-v-012ab35c",null);t.default=l.exports}});
//# sourceMappingURL=25.6f7ee224cfb823f4bb14.js.map