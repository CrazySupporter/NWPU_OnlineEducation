webpackJsonp([14],{"7d5t":function(e,t){},ejUA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("mvHQ"),i=n.n(s),a=n("3IC3"),r=n("mtWM"),o=n.n(r),l=(n("Cp0N"),{name:"SignInbyPhone",data:function(){return{heads:{phone:"手机号"},title:"欢迎登录",inputs:{phone:"",verify_code:void 0},user:{nickname:"",password:""},verify:{code_generated:"",prompt:"发送验证码",countdown:60,disableQ:!1},loadingQ:!1,expire_secs:360}},methods:{handleSignIn:function(){var e=this;this.loadingQ=!0,Object(a.loginbyPhoneSQL)(this,this.inputs).then(function(t){e.loadingQ=!1,e.$message.success("登录成功！"+t.results.realname),e.$emit("logined",t.results),window.location.href="/home"}).catch(function(t){e.loadingQ=!1,"USER_NOT_FOUND."===t.details?e.$message.error("手机号未注册！"):"WRONG_VERIFICATION_CODE."===t.details?e.$message.error("登录失败，验证码错误！"):e.$message.error("登录失败，未知错误！"+i()(t.details))})},handleVerification:function(){var e,t=this;this.inputs.phone<=1e10||this.inputs.phone>=19999999999?this.$message("请输入中国大陆11位手机号"):Object(a.queryPhoneSQL)(this,this.inputs).then(function(n){if("FAILED."!==n.status){t.inputs.userid=n.user.id,t.user.nickname=n.user.nickname,t.user.password=n.user.password,e=window.setInterval(function(){t.verify.disableQ=!0,t.verify.countdown--,t.verify.prompt=t.verify.countdown+"s后重新发送",t.verify.countdown<=0&&(window.clearInterval(e),t.verify.disableQ=!1,t.verify.prompt="重新发送验证码",t.verify.countdown=60)},1e3),t.$message.warning("验证码已发送！请注意查收"),t.$refs.verify_input.focus();o.a.post("/api/user/verification",{number:t.inputs.phone}).then(function(e){})}else t.$message("该手机号还未被注册")}).catch(function(e){"FAILED."===e.status&&t.$message("该手机号还未被注册")})},handleFocusingOnVerify:function(){this.inputs.verify_code=void 0},handleSignInbyNickname:function(){this.$router.push("/user/sign_in"),this.loadingQ=!0}}}),c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingQ,expression:"loadingQ"}],staticClass:"box-card"},[n("div",{staticClass:"clear-fix",attrs:{slot:"header"},slot:"header"},[n("h1",[e._v(e._s(e.title))])]),e._v(" "),n("div",{on:{keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSignIn(t):null}}},[e._l(e.heads,function(t,s,i){return n("el-row",{key:i},[n("el-col",{staticClass:"register-prompt",attrs:{span:8}},[n("label",{attrs:{for:s}},[n("i",{staticClass:"el-icon-caret-right",attrs:{slot:"prepend"},slot:"prepend"}),e._v("\n                     "+e._s(e.heads[s])+"：\n                 ")])]),e._v(" "),n("el-col",{attrs:{span:15}},[n("el-input","password"===s||"re_password"===s?{staticClass:"input-box",attrs:{id:s,type:"password",clearable:"",placeholder:e.heads[s]},model:{value:e.inputs[s],callback:function(t){e.$set(e.inputs,s,t)},expression:"inputs[key]"}}:{staticClass:"input-box",attrs:{id:s,type:"text",clearable:"",placeholder:e.heads[s]},model:{value:e.inputs[s],callback:function(t){e.$set(e.inputs,s,t)},expression:"inputs[key]"}})],1)],1)}),e._v(" "),n("el-row",[n("el-col",{staticClass:"register-prompt",attrs:{span:8}},[n("label",{attrs:{for:"verify_code"}},[n("i",{staticClass:"el-icon-caret-right",attrs:{slot:"prepend"},slot:"prepend"}),e._v("\n                     手机验证码：\n                 ")])]),e._v(" "),n("el-col",{attrs:{span:7}},[n("el-input-number",{ref:"verify_input",staticClass:"input-box",attrs:{id:"verify_code",min:1e5,max:999999,controls:!1},on:{focus:e.handleFocusingOnVerify},model:{value:e.inputs.verify_code,callback:function(t){e.$set(e.inputs,"verify_code",t)},expression:"inputs.verify_code"}})],1),e._v(" "),n("el-col",{staticClass:"verification-button",attrs:{span:7}},[n("el-button",{attrs:{disabled:e.verify.disableQ},on:{click:e.handleVerification}},[e._v("\n                     "+e._s(e.verify.prompt)+"\n                 ")])],1)],1)],2),e._v(" "),n("div",{attrs:{align:"center"}},[n("el-row",[n("el-button",{staticClass:"register-button",attrs:{type:"primary"},on:{click:e.handleSignIn}},[e._v("登录")])],1),e._v(" "),n("el-row",[n("el-button",{attrs:{type:"text"},on:{click:e.handleSignInbyNickname}},[e._v("用户名密码登录")])],1)],1)])},staticRenderFns:[]};var d=n("VU/8")(l,c,!1,function(e){n("7d5t")},"data-v-78b10c3b",null);t.default=d.exports}});
//# sourceMappingURL=14.02d8dffa5e0d5741194d.js.map